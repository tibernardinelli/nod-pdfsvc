$(function(){if("undefined"!=typeof AccountDock){var c=$("#billing"),n=c.data("stripe-id"),o=AccountDock.configure({key:"ad_acco_9fef40229188e8c0",customer:n});c.on("click",function(){o.open()})}});
$(function(){function t(){e=$("#npm-search").outerWidth()-$("#site-search-submit").outerWidth(),o.innerHTML=".autocomplete-container, .autocomplete-suggestions, #powered-by-constructor-io { width: "+e+"px !important }"}var e,o=document.createElement("style");document.head.appendChild(o),$(window).resize(t),t(),$.getScript("//cnstrc.com/js/ac.js",function(){$("#site-search").constructorAutocomplete({key:"CD06z4gVeqSXRiDL2ZNK",directResults:!0,maxHeight:400})})});
!function(e,t,n,a,c,o,i){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(n),i=t.getElementsByTagName(n)[0],o.async=1,o.src=a,i.parentNode.insertBefore(o,i)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",$('meta[name="x-npm:ga:id"]').attr("content"),"auto"),ga("require","displayfeatures"),ga("require","ec"),ga("send","pageview"),$(document).ready(function(){$('meta[name="x-npm:ga:user-id"]').each(function(e,t){ga("set","userId",t.getAttribute("content"))}),$(document).on("click",".hiring-widget a",function(e){ga("send","event","Hiring Ads","click",$(this).parent().data("id"))}),$(document).on("click",".ad a",function(e){ga("send","event","Hiring Ads","click",$(this).attr("title"))});try{var e=JSON.parse($('meta[name="x-npm:ga:dimensions"]').attr("content")),t=function(t,n){var a={},c=e[n];return a[c]=String(t),a};$(".promotion").each(function(e,n){var a=$(n).data("promotion-id"),c=$(n).data("promotion-spot");ga("ec","addPromo",{id:String(a),position:c}),ga("send","event","promotion","viewed",a,t(a,c))}),$(document).on("click",".promotion a",function(e){var t=$(this).closest(".promotion").data("promotion-id");ga("ec:setAction","promo_click"),ga("send","event","promotion","clicked",t)})}catch(e){console.error(e)}$('meta[name="x-npm:ga:event"]').each(function(e,t){var n=["send","event"];try{ga.apply(null,n.concat(JSON.parse(t.getAttribute("content"))))}catch(e){console.error(e)}}),$('[rel="npm:subscribe-private-packages"]').on("click",function(){ga("ec:addProduct",{id:"solo",name:"npmSolo",category:"SaaS",price:"7.00",quantity:1}),ga("ec:setAction","checkout",{step:1}),ga("send","event","SaaS","Solo Signup")}),$('[rel="npm:create-org"]').on("click",function(){ga("ec:addProduct",{id:"orgs-7",name:"npm Orgs",category:"SaaS",price:"7.00",quantity:2}),ga("ec:setAction","checkout",{step:1}),ga("send","event","SaaS","Orgs Signup")}),$("#subscribe-private-packages-form button[type=submit]").on("click",function(){ga("ec:addProduct",{id:"solo",name:"npmSolo",category:"SaaS",price:"7.00",quantity:1}),ga("ec:setAction","checkout",{step:2}),ga("send","event","SaaS","Solo Subscription")});var n=$("#create-org-form");n.on("click","button[type=submit]",function(){ga("ec:addProduct",{id:"orgs-7",name:"npm Orgs",category:"SaaS",price:"7.00",quantity:2}),ga("ec:setAction","checkout",{step:2}),ga("send","event","SaaS","Create Org"),n.is("[data-need-card]")||(ga("ec:addProduct",{id:"orgs-7",name:"npm Orgs",category:"SaaS",price:"7.00",quantity:2}),ga("ec:setAction","purchase",{id:n.find("[name=orgScope]").val()+"-"+$("#salutation-username").text()+"-"+new Date,coupon:null}),ga("send","event","SaaS","Orgs Purchase"))}),$('nav a[href="/enterprise"]').click(function(e){ga("send","event","npm Enterprise","click")}),$(document).on("click","[data-event-trigger='click']",function(e){ga("send","event",$(this).data("eventName"),"click")}),$('.pane a[href="/enterprise"]').click(function(e){var t=$(this).text();ga("set","dimension4",t),ga("send","event","Enterprise","ctaClick",t)}),$("body").on("click","a, button",function(e){var t=$(e.target).text(),n=$(e.target).data("event-name")||($(e.target).is("header a")?"header":"click");ga("set","dimension4",t),ga("send","event","navigation",n,t)})});
$(function(){var e=$('meta[name="x-stripe-key"]').attr("content");if("undefined"!=typeof StripeCheckout&&e){var a=StripeCheckout.configure({key:e,image:"/static/images/n-64.png",name:"npm, Inc.",billingAddress:!0,token:function(e,a){var t={};Object.keys(e.card).forEach(function(a){t[a]=$(".output-"+a).text(),$(".output-"+a).text(e.card[a])}),$.ajax({method:"POST",json:!0,url:"/settings/api/billing",data:{stripeToken:e.id},headers:{"x-csrf-token":window.crumb}}).then(function(e){Object.keys(e.card).forEach(function(a){$(".output-"+a).text(e.card[a])})},function(e){Object.keys(t).forEach(function(e){$(".output-"+e).text(t[e])}),$(".alert-container .alert").slideUp(function(){$(this).remove()});var a=$('<div class="alert alert-error alert-dismissable"><button class="close" data-dismiss="alert"><i class="fa fa-times"></i></button><div class="media mtn"><div class="media-left"><i class="fa alert-icon fa-exclamation-triangle"></i></div><div class="media-body em-high">There was an error updating your payment information.</div></div></div>').hide();$(".alert-container").append(a),a.slideDown()})}});$(document).on("click",".action-change-payment-info",function(e){e.preventDefault(),a.open({"panel-label":"Update Card"})}),$(window).on("popstate",function(){a.close()}),$(".action-checkout").each(function(){var a=$(this),t=StripeCheckout.configure({key:e,image:"/static/images/n-64.png",billingAddress:!0,name:"npm, Inc.",token:function(e,t){a.find('[name="stripeToken"]').val(e.id),a.find('[name="email"]').val(e.email),a.is("#subscribe-private-packages-form")&&ga&&(ga("ec:addProduct",{id:"solo",name:"npm Solo",category:"SaaS",price:"7.00",quantity:"1"}),ga("ec:setAction","purchase",{id:e.id,coupon:null}),ga("send","event","SaaS","Solo Purchase")),a.is("#create-org-form")&&ga&&(ga("ec:addProduct",{id:"orgs-7",name:"npm Orgs",category:"SaaS",price:"7.00",quantity:"2"}),ga("ec:setAction","purchase",{id:e.id,coupon:null}),ga("send","event","SaaS","Orgs Purchase")),a.submit()}});a.is("[data-need-card]")&&(a.is("[data-open-signup]")&&(ga&&(ga("ec:addProduct",{id:"solo",name:"npmSolo",category:"SaaS",price:"7.00",quantity:1}),ga("ec:setAction","checkout",{step:2}),ga("send","event","SaaS","Solo Subscription")),t.open({amount:a.find("[name=amount]").val()})),a.on("submit",function(e){var n=$("#org-plan-type-free").is(":checked");a.find('[name="stripeToken"]').val()||n||(e.preventDefault(),t.open({amount:a.find("[name=amount]").val()}))})),$(window).on("popstate",function(){t.close()})})}});